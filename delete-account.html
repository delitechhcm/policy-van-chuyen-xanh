<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Yêu cầu xóa tài khoản</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: 'class',
      }
    </script>
  </head>
  <body class="bg-white dark:bg-zinc-900 text-zinc-900 dark:text-zinc-50 min-h-screen">
    <main class="max-w-4xl mx-auto px-4 py-8">
      <header class="mb-8 flex items-center gap-4">
        <img 
          src="vcx-driver-logo.png" 
          alt="VCX Driver Logo" 
          class="h-12 w-auto"
        />
        <h1 class="text-2xl font-bold text-green-600 dark:text-green-400">
          Vận chuyển xanh
        </h1>
      </header>
      <div id="app"></div>
    </main>

    <script>
      // State management
      let state = {
        formData: {
          fullName: "",
          phone: "",
          email: "",
          reason: "",
          confirmChecked: false,
        },
        isSubmitted: false,
        isSubmitting: false,
      };

      // Render function
      function render() {
        const app = document.getElementById('app');
        if (!app) return;

        if (state.isSubmitted) {
          app.innerHTML = `
            <div class="mb-10 p-8 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg">
              <div class="flex items-start gap-4">
                <div class="flex-shrink-0">
                  <svg
                    class="w-12 h-12 text-green-600 dark:text-green-400"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                    />
                  </svg>
                </div>
                <div class="flex-1">
                  <h2 class="text-2xl font-semibold mb-3 text-black dark:text-zinc-50">
                    Đã gửi thông tin thành công!
                  </h2>
                  <p class="text-base text-zinc-700 dark:text-zinc-300 mb-4">
                    Yêu cầu xóa tài khoản của bạn đã được gửi thành công. Chúng tôi đã nhận được thông tin và sẽ xét duyệt yêu cầu của bạn trong vòng <strong>7-14 ngày làm việc</strong>.
                  </p>
                  <div class="bg-white dark:bg-zinc-800 rounded-lg p-4 mb-4">
                    <p class="text-sm font-semibold text-zinc-600 dark:text-zinc-400 mb-2">
                      Thông tin đã gửi:
                    </p>
                    <ul class="space-y-1 text-sm text-zinc-700 dark:text-zinc-300">
                      <li><strong>Họ tên:</strong> ${escapeHtml(state.formData.fullName)}</li>
                      <li><strong>Số điện thoại:</strong> ${escapeHtml(state.formData.phone)}</li>
                      <li><strong>Email:</strong> ${escapeHtml(state.formData.email)}</li>
                      <li><strong>Lý do:</strong> ${escapeHtml(getReasonLabel(state.formData.reason))}</li>
                    </ul>
                  </div>
                  <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4">
                    <p class="text-sm text-zinc-700 dark:text-zinc-300">
                      <strong>Lưu ý:</strong> Bạn sẽ nhận được email xác nhận khi yêu cầu được xử lý. Vui lòng kiểm tra hộp thư đến và thư mục spam của bạn.
                    </p>
                  </div>
                </div>
              </div>
            </div>
          `;
          return;
        }

        app.innerHTML = `
          <section class="mb-10 pb-10 border-b border-zinc-200 dark:border-zinc-800">
            <h2 class="text-2xl font-semibold mb-4 text-black dark:text-zinc-50">
              Điền thông tin yêu cầu xóa tài khoản
            </h2>
            <p class="text-base text-zinc-700 dark:text-zinc-300 mb-6">
              Vui lòng điền đầy đủ thông tin bên dưới để gửi yêu cầu xóa tài khoản của bạn.
            </p>

            <form id="deleteAccountForm" class="space-y-6">
              <div>
                <label
                  for="fullName"
                  class="block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2"
                >
                  Họ và tên <span class="text-red-500">*</span>
                </label>
                <input
                  type="text"
                  id="fullName"
                  name="fullName"
                  required
                  value="${escapeHtml(state.formData.fullName)}"
                  class="w-full px-4 py-3 border border-zinc-300 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-zinc-900 dark:text-zinc-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  placeholder="Nhập họ và tên của bạn"
                />
              </div>

              <div>
                <label
                  for="phone"
                  class="block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2"
                >
                  Số điện thoại đăng ký <span class="text-red-500">*</span>
                </label>
                <input
                  type="tel"
                  id="phone"
                  name="phone"
                  required
                  value="${escapeHtml(state.formData.phone)}"
                  class="w-full px-4 py-3 border border-zinc-300 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-zinc-900 dark:text-zinc-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  placeholder="Nhập số điện thoại đăng ký tài khoản"
                  pattern="[0-9]{10,11}"
                />
                <p class="mt-1 text-sm text-zinc-500 dark:text-zinc-400">
                  Số điện thoại phải khớp với số đã đăng ký tài khoản
                </p>
              </div>

              <div>
                <label
                  for="email"
                  class="block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2"
                >
                  Email đăng ký <span class="text-red-500">*</span>
                </label>
                <input
                  type="email"
                  id="email"
                  name="email"
                  required
                  value="${escapeHtml(state.formData.email)}"
                  class="w-full px-4 py-3 border border-zinc-300 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-zinc-900 dark:text-zinc-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  placeholder="Nhập email đăng ký tài khoản"
                />
                <p class="mt-1 text-sm text-zinc-500 dark:text-zinc-400">
                  Email phải khớp với email đã đăng ký tài khoản
                </p>
              </div>

              <div>
                <label
                  for="reason"
                  class="block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2"
                >
                  Lý do xóa tài khoản <span class="text-red-500">*</span>
                </label>
                <select
                  id="reason"
                  name="reason"
                  required
                  class="w-full px-4 py-3 border border-zinc-300 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-zinc-900 dark:text-zinc-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                >
                  <option value="">-- Chọn lý do --</option>
                  <option value="khong-su-dung" ${state.formData.reason === 'khong-su-dung' ? 'selected' : ''}>Không sử dụng dịch vụ nữa</option>
                  <option value="gap-van-de" ${state.formData.reason === 'gap-van-de' ? 'selected' : ''}>Gặp vấn đề với ứng dụng</option>
                  <option value="chuyen-cong-viec" ${state.formData.reason === 'chuyen-cong-viec' ? 'selected' : ''}>Chuyển công việc khác</option>
                  <option value="bao-mat" ${state.formData.reason === 'bao-mat' ? 'selected' : ''}>Lo ngại về bảo mật</option>
                  <option value="khac" ${state.formData.reason === 'khac' ? 'selected' : ''}>Lý do khác</option>
                </select>
              </div>

              <div>
                <label class="flex items-start gap-3 cursor-pointer">
                  <input
                    type="checkbox"
                    name="confirmChecked"
                    required
                    ${state.formData.confirmChecked ? 'checked' : ''}
                    class="mt-1 w-5 h-5 text-blue-600 border-zinc-300 dark:border-zinc-700 rounded focus:ring-blue-500 dark:bg-zinc-800"
                  />
                  <span class="text-sm text-zinc-700 dark:text-zinc-300">
                    Tôi xác nhận đã đọc và hiểu rõ các cảnh báo về việc xóa tài khoản. Tôi hiểu rằng đây là hành động không thể hoàn tác và tất cả dữ liệu sẽ bị xóa vĩnh viễn. <span class="text-red-500">*</span>
                  </span>
                </label>
              </div>

              <div class="pt-4">
                <button
                  type="submit"
                  ${state.isSubmitting ? 'disabled' : ''}
                  class="w-full sm:w-auto px-8 py-3 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2"
                >
                  ${state.isSubmitting ? `
                    <span class="flex items-center justify-center gap-2">
                      <svg
                        class="animate-spin h-5 w-5"
                        xmlns="http://www.w3.org/2000/svg"
                        fill="none"
                        viewBox="0 0 24 24"
                      >
                        <circle
                          class="opacity-25"
                          cx="12"
                          cy="12"
                          r="10"
                          stroke="currentColor"
                          stroke-width="4"
                        ></circle>
                        <path
                          class="opacity-75"
                          fill="currentColor"
                          d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                        ></path>
                      </svg>
                      Đang gửi...
                    </span>
                  ` : 'Gửi yêu cầu xóa tài khoản'}
                </button>
              </div>
            </form>
          </section>
        `;

        // Attach event listeners
        attachEventListeners();
      }

      function attachEventListeners() {
        const form = document.getElementById('deleteAccountForm');
        if (!form) return;

        // Handle form submission
        form.addEventListener('submit', async function(e) {
          e.preventDefault();
          
          // Get form data
          const formDataObj = {
            fullName: document.getElementById('fullName').value,
            phone: document.getElementById('phone').value,
            email: document.getElementById('email').value,
            reason: document.getElementById('reason').value,
            confirmChecked: document.querySelector('input[name="confirmChecked"]').checked,
          };

          state.formData = formDataObj;
          state.isSubmitting = true;
          render();

          // Simulate API call
          await new Promise((resolve) => setTimeout(resolve, 1000));

          state.isSubmitting = false;
          state.isSubmitted = true;
          render();
        });

        // Handle input changes
        const inputs = form.querySelectorAll('input, select');
        inputs.forEach(input => {
          input.addEventListener('input', function(e) {
            const { name, value, type } = e.target;
            const checked = e.target.checked;
            
            if (type === 'checkbox') {
              state.formData[name] = checked;
            } else {
              state.formData[name] = value;
            }
          });
        });
      }

      function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }

      function getReasonLabel(value) {
        const reasons = {
          'khong-su-dung': 'Không sử dụng dịch vụ nữa',
          'gap-van-de': 'Gặp vấn đề với ứng dụng',
          'chuyen-cong-viec': 'Chuyển công việc khác',
          'bao-mat': 'Lo ngại về bảo mật',
          'khac': 'Lý do khác',
        };
        return reasons[value] || value;
      }

      // Initialize
      document.addEventListener('DOMContentLoaded', function() {
        render();
      });
    </script>
  </body>
</html>
